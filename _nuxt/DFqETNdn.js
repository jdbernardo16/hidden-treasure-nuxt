import{J as ce,K as oe,u as I,L as Me,M as Pe,N as Te,O as Le,d as H,P as ne,o as r,c as p,e as t,t as u,Q as w,R as S,b as e,i as y,a as $,S as _e,F as q,r as ee,x as le,s as ge,_ as te,D as ae,p as he,h as A,E as j,T as Ae,j as ye,w as L,U as Z,k as ie,f as K,V as Ie,W as Ne,X as De,G as Oe,Y as je,n as qe,Z as pe,$ as He,g as ze,a0 as Be}from"./Bd6rPcjx.js";import{_ as Ge}from"./DYWR-zbK.js";import{_ as Re}from"./CnSc_Vfe.js";import{_ as ve,a as be}from"./BsKZt6bE.js";import{a as We}from"./CNOcYL9V.js";import"./BjaOlWIG.js";const Ye=window.setInterval;function re(){const m=ce("orderInput",()=>({customerNote:"",paymentMethod:"",shipToDifferentAddress:!1,metaData:[{key:"order_via",value:"WooNuxt"}]})),l=ce("isProcessingOrder",()=>!1);async function i(){var c;const{customer:o,viewer:d}=oe(),{isUpdatingCart:h,refreshCart:a}=I();h.value=!0;try{const{updateCustomer:f}=await Me({input:{id:(c=d==null?void 0:d.value)==null?void 0:c.id,shipping:m.value.shipToDifferentAddress?o.value.shipping:o.value.billing,billing:o.value.billing}});f&&a()}catch(f){console.error(f)}}function n(o){return new Promise(d=>{const c=window.innerWidth/2-375,f=window.innerHeight/2-750/2+80,v=window.open(o,"",`width=750,height=750,top=${f},left=${c}`),k=Ye(()=>{v!=null&&v.closed&&(clearInterval(k),d(!0))},500)})}return{orderInput:m,isProcessingOrder:l,proccessCheckout:async(o=!1)=>{var U,E,O,B,J;const{customer:d,loginUser:h}=oe(),a=Pe(),{replaceQueryParam:c}=Te(),{emptyCart:f,refreshCart:v}=I();l.value=!0;const{username:k,password:z,shipToDifferentAddress:N}=m.value,D=(U=d.value)==null?void 0:U.billing,se=N?(E=d.value)==null?void 0:E.shipping:D;try{let M={billing:D,shipping:se,metaData:m.value.metaData,paymentMethod:m.value.paymentMethod.id,customerNote:m.value.customerNote,shipToDifferentAddress:N,transactionId:m.value.transactionId,isPaid:o};m.value.createAccount&&(M.account={username:k,password:z});const{checkout:b}=await Le(M);m.value.createAccount&&await h({username:k,password:z});const G=(O=b==null?void 0:b.order)==null?void 0:O.databaseId,R=(B=b==null?void 0:b.order)==null?void 0:B.orderKey,W=m.value.paymentMethod.id,g=W==="paypal"||W==="ppcp-gateway";if(await(b==null?void 0:b.redirect)&&g){const _=window.location.origin;let C=(b==null?void 0:b.redirect)??"";const P=`${_}/checkout/order-received/${G}/?key=${R}&from_paypal=true`,V=`${_}/checkout/?cancel_order=true&from_paypal=true`;C=c("return",P,C),C=c("cancel_return",V,C),C=c("bn","WooNuxt_Cart",C),await n(C)&&a.push(`/checkout/order-received/${G}/?key=${R}&fetch_delay=true`)}else a.push(`/checkout/order-received/${G}/?key=${R}`);if(await(b==null?void 0:b.result)!=="success")return alert("There was an error processing your order. Please try again."),window.location.reload(),b;await f(),await v()}catch(M){l.value=!1;const b=(J=M==null?void 0:M.gqlErrors)==null?void 0:J[0].message;return b!=null&&b.includes("An account is already registered with your email address")?(alert("An account is already registered with your email address"),null):(alert(b),null)}l.value=!1},updateShippingLocation:i}}const Fe={class:"grid w-full gap-4 lg:grid-cols-2"},Ke={class:"w-full"},Ze={for:"first-name"},Je={class:"w-full"},Xe={for:"last-name"},Qe={key:0,class:"w-full col-span-full"},et={for:"address1"},tt={key:1,class:"w-full col-span-full"},st={for:"address2"},ot={key:2,class:"w-full"},nt={for:"city"},lt={key:3,class:"w-full"},at={for:"state"},it={key:4,class:"w-full"},rt={for:"country"},dt={key:5,class:"w-full"},ut={for:"zip"},ct={key:6,class:"w-full col-span-full"},pt={for:"phone"},mt=H({__name:"BillingDetails",props:{modelValue:{type:Object,required:!0}},setup(m){const{updateShippingLocation:l}=re(),{isBillingAddressEnabled:i}=I(),s=ne(m,"modelValue");return(o,d)=>{const h=ve,a=be;return r(),p("div",Fe,[t("div",Ke,[t("label",Ze,u(o.$t("messages.billing.firstName")),1),w(t("input",{id:"first-name","onUpdate:modelValue":d[0]||(d[0]=c=>e(s).firstName=c),placeholder:"John",autocomplete:"given-name",type:"text",required:""},null,512),[[S,e(s).firstName]])]),t("div",Je,[t("label",Xe,u(o.$t("messages.billing.lastName")),1),w(t("input",{id:"last-name","onUpdate:modelValue":d[1]||(d[1]=c=>e(s).lastName=c),placeholder:"Doe",autocomplete:"family-name",type:"text",required:""},null,512),[[S,e(s).lastName]])]),e(i)?(r(),p("div",Qe,[t("label",et,u(o.$t("messages.billing.address1")),1),w(t("input",{id:"address1","onUpdate:modelValue":d[2]||(d[2]=c=>e(s).address1=c),placeholder:"O'Connell Street 47",autocomplete:"street-address",type:"text",required:""},null,512),[[S,e(s).address1]])])):y("",!0),e(i)?(r(),p("div",tt,[t("label",st,u(o.$t("messages.billing.address2"))+" ("+u(o.$t("messages.general.optional"))+")",1),w(t("input",{id:"address2","onUpdate:modelValue":d[3]||(d[3]=c=>e(s).address2=c),placeholder:"Apartment, studio, or floor",autocomplete:"address-line2",type:"text"},null,512),[[S,e(s).address2]])])):y("",!0),e(i)?(r(),p("div",ot,[t("label",nt,u(o.$t("messages.billing.city")),1),w(t("input",{id:"city","onUpdate:modelValue":d[4]||(d[4]=c=>e(s).city=c),placeholder:"New York",autocomplete:"locality",type:"text",required:""},null,512),[[S,e(s).city]])])):y("",!0),e(i)?(r(),p("div",lt,[t("label",at,u(o.$t("messages.billing.state"))+" ("+u(o.$t("messages.general.optional"))+")",1),$(h,{id:"state",modelValue:e(s).state,"onUpdate:modelValue":d[5]||(d[5]=c=>e(s).state=c),"default-value":e(s).state,"country-code":e(s).country,onChange:e(l),autocomplete:"address-level1"},null,8,["modelValue","default-value","country-code","onChange"])])):y("",!0),e(i)?(r(),p("div",it,[t("label",rt,u(o.$t("messages.billing.country")),1),$(a,{id:"country",modelValue:e(s).country,"onUpdate:modelValue":d[6]||(d[6]=c=>e(s).country=c),"default-value":e(s).country,onChange:e(l),autocomplete:"country"},null,8,["modelValue","default-value","onChange"])])):y("",!0),e(i)?(r(),p("div",dt,[t("label",ut,u(o.$t("messages.billing.zip")),1),w(t("input",{id:"zip","onUpdate:modelValue":d[7]||(d[7]=c=>e(s).postcode=c),placeholder:"10001",autocomplete:"postal-code",type:"text",required:""},null,512),[[S,e(s).postcode]])])):y("",!0),e(i)?(r(),p("div",ct,[t("label",pt,u(o.$t("messages.billing.phone"))+" ("+u(o.$t("messages.general.optional"))+")",1),w(t("input",{id:"phone","onUpdate:modelValue":d[8]||(d[8]=c=>e(s).phone=c),placeholder:"+1 234 567 8901",autocomplete:"tel",type:"tel"},null,512),[[S,e(s).phone]])])):y("",!0)])}}}),ft=Object.assign(mt,{__name:"BillingDetails"}),_t={class:"grid w-full gap-4 lg:grid-cols-2"},gt={class:"w-full"},ht={for:"first-name"},yt={class:"w-full"},vt={for:"last-name"},bt={class:"w-full col-span-full"},$t={for:"address1"},wt={class:"w-full col-span-full"},xt={for:"address2"},kt={class:"w-full"},St={for:"city"},Ct={class:"w-full"},Vt={for:"state"},Ut={class:"w-full"},Et={for:"country"},Mt={class:"w-full"},Pt={for:"zip"},Tt={class:"w-full col-span-full"},Lt={for:"phone"},At=H({__name:"ShippingDetails",props:{modelValue:{type:Object,required:!0}},setup(m){const{updateShippingLocation:l}=re(),n=ne(m,"modelValue");return(s,o)=>{const d=ve,h=be;return r(),p("div",_t,[t("div",gt,[t("label",ht,u(s.$t("messages.billing.firstName")),1),w(t("input",{id:"first-name","onUpdate:modelValue":o[0]||(o[0]=a=>e(n).firstName=a),placeholder:"John",autocomplete:"given-name",type:"text",required:""},null,512),[[S,e(n).firstName]])]),t("div",yt,[t("label",vt,u(s.$t("messages.billing.lastName")),1),w(t("input",{id:"last-name","onUpdate:modelValue":o[1]||(o[1]=a=>e(n).lastName=a),placeholder:"Doe",autocomplete:"family-name",type:"text",required:""},null,512),[[S,e(n).lastName]])]),t("div",bt,[t("label",$t,u(s.$t("messages.billing.address1")),1),w(t("input",{id:"address1","onUpdate:modelValue":o[2]||(o[2]=a=>e(n).address1=a),placeholder:"O'Connell Street 47",autocomplete:"street-address",type:"text",required:""},null,512),[[S,e(n).address1]])]),t("div",wt,[t("label",xt,u(s.$t("messages.billing.address2"))+" ("+u(s.$t("messages.general.optional"))+")",1),w(t("input",{id:"address2","onUpdate:modelValue":o[3]||(o[3]=a=>e(n).address2=a),placeholder:"Apartment, studio, or floor",autocomplete:"address-line2",type:"text"},null,512),[[S,e(n).address2]])]),t("div",kt,[t("label",St,u(s.$t("messages.billing.city")),1),w(t("input",{id:"city","onUpdate:modelValue":o[4]||(o[4]=a=>e(n).city=a),placeholder:"New York",autocomplete:"locality",type:"text",required:""},null,512),[[S,e(n).city]])]),t("div",Ct,[t("label",Vt,u(s.$t("messages.billing.state"))+" ("+u(s.$t("messages.general.optional"))+")",1),$(d,{id:"state",modelValue:e(n).state,"onUpdate:modelValue":o[5]||(o[5]=a=>e(n).state=a),"default-value":e(n).state,"country-code":e(n).country,onChange:e(l)},null,8,["modelValue","default-value","country-code","onChange"])]),t("div",Ut,[t("label",Et,u(s.$t("messages.billing.country")),1),$(h,{id:"country",modelValue:e(n).country,"onUpdate:modelValue":o[6]||(o[6]=a=>e(n).country=a),"default-value":e(n).country,onChange:e(l)},null,8,["modelValue","default-value","onChange"])]),t("div",Mt,[t("label",Pt,u(s.$t("messages.billing.zip")),1),w(t("input",{id:"zip","onUpdate:modelValue":o[7]||(o[7]=a=>e(n).postcode=a),placeholder:"10001",autocomplete:"postal-code",type:"text",required:""},null,512),[[S,e(n).postcode]])]),t("div",Tt,[t("label",Lt,u(s.$t("messages.billing.phone"))+" ("+u(s.$t("messages.general.optional"))+")",1),w(t("input",{id:"phone","onUpdate:modelValue":o[8]||(o[8]=a=>e(n).phone=a),placeholder:"+1 234 567 8901",autocomplete:"tel",type:"tel"},null,512),[[S,e(n).phone]])])])}}}),It=Object.assign(At,{__name:"ShippingDetails"}),Nt={class:"grid gap-4 shipping-options"},Dt=["onClick"],Ot=["innerHTML"],jt={class:"font-semibold text-gray-600"},qt={__name:"ShippingOptions",props:{options:{type:Array,required:!0},activeOption:{type:String,required:!0}},setup(m){var o;const{updateShippingMethod:l}=I(),i=ge(),n=((o=i==null?void 0:i.public)==null?void 0:o.CURRENCY_SYMBOL)||"$",s=async d=>{await l(d)};return(d,h)=>{const a=te;return r(),p("div",Nt,[(r(!0),p(q,null,ee(m.options,c=>(r(),p("div",{key:c.id,class:le(["flex items-center justify-between option",{"active-option":c.id===m.activeOption}]),onClick:f=>s(c.id)},[t("div",null,[t("div",{class:"text-sm leading-tight text-gray-500",innerHTML:c.label},null,8,Ot),t("div",jt,u(e(n))+u(c.cost),1)]),$(a,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-brand-gold checkmark opacity-0"})],10,Dt))),128))])}}},Ht=_e(qt,[["__scopeId","data-v-8ba09eac"]]),zt={class:"flex gap-4 leading-tight flex-wrap"},Bt=["onClick","title"],Gt=["innerHTML"],Rt={key:0,class:"prose block w-full"},Wt=["innerHTML"],Yt=H({__name:"PaymentOptions",props:{modelValue:{},paymentGateways:{}},emits:["update:modelValue"],setup(m,{emit:l}){const i=m,n=ne(i,"modelValue"),s=ae(()=>n.value),o=l,d=h=>{o("update:modelValue",h)};return he(()=>{var h,a;(h=i.paymentGateways)!=null&&h.nodes.length&&d((a=i.paymentGateways)==null?void 0:a.nodes[0])}),(h,a)=>{var f;const c=te;return r(),p("div",zt,[(r(!0),p(q,null,ee((f=h.paymentGateways)==null?void 0:f.nodes,v=>(r(),p("div",{key:v.id,class:le(["option",{"active-option":v.id===e(s).id}]),onClick:k=>d(v),title:(v==null?void 0:v.description)||(v==null?void 0:v.title)||"Payment Method"},[v.id==="stripe"?(r(),A(c,{key:0,name:"ion:card-outline",size:"20"})):v.id==="paypal"?(r(),A(c,{key:1,name:"ion:logo-paypal",size:"20"})):(r(),A(c,{key:2,name:"ion:cash-outline",size:"20"})),t("span",{class:"whitespace-nowrap",innerHTML:v.title},null,8,Gt),$(c,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-brand-gold checkmark opacity-0"})],10,Bt))),128)),e(s).description?(r(),p("div",Rt,[t("p",{class:"text-sm text-gray-500",innerHTML:e(s).description},null,8,Wt)])):y("",!0)])}}}),Ft=Object.assign(_e(Yt,[["__scopeId","data-v-ebed9aa5"]]),{__name:"PaymentOptions"}),Kt={id:"card-element"},Zt=H({__name:"StripeElement",props:["stripe"],emits:["updateElement"],setup(m,{emit:l}){const{cart:i}=I(),n=ae(()=>i.value&&parseFloat(i.value.rawTotal)*100),s=l;let o=null;const d={mode:"payment",currency:"eur",amount:n.value},h=async()=>{o=m.stripe.elements(d),o.create("card",{hidePostalCode:!0}).mount("#card-element"),s("updateElement",o)};return he(()=>{h()}),(a,c)=>(r(),p("div",Kt))}}),Jt=Object.assign(Zt,{__name:"StripeElement"}),Xt=["placeholder"],Qt=["disabled"],es={key:1},ts=["innerHTML"],ss={key:0,class:"text-xs font-semibold uppercase flex flex-wrap gap-2"},os={key:0,class:"bg-brand-gold border-brand-gold border rounded-md flex bg-opacity-5 border-opacity-10 text-brand-gold leading-none p-1.5 gap-1 items-center"},ns=["innerHTML"],ls=H({__name:"AddCoupon",setup(m){const{cart:l,isUpdatingCoupon:i,applyCoupon:n,removeCoupon:s}=I(),o=j(""),d=j("");async function h(){const{message:a}=await n(o.value);a?d.value=a:(o.value="",d.value="")}return(a,c)=>{const f=ie,v=te;return r(),p("div",null,[t("form",{class:"flex gap-1",onSubmit:ye(h,["prevent"])},[w(t("input",{id:"couponCode","onUpdate:modelValue":c[0]||(c[0]=k=>Ae(o)?o.value=k:null),type:"text",placeholder:a.$t("messages.shop.couponCode"),class:"w-full px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm outline-none",required:""},null,8,Xt),[[S,e(o)]]),t("button",{class:"flex items-center justify-center px-4 py-2 text-white bg-gray-800 border rounded-md shadow-sm outline-none min-w-20",disabled:e(i)},[e(i)?(r(),A(f,{key:0,color:"#fff",size:"16"})):(r(),p("span",es,u(a.$t("messages.general.apply")),1))],8,Qt)],32),$(Z,{name:"scale-y",mode:"out-in"},{default:L(()=>[e(d)?(r(),p("div",{key:0,class:"mt-2 text-xs text-red-600",innerHTML:e(d)},null,8,ts)):y("",!0)]),_:1}),$(Z,{name:"scale-y",mode:"out-in"},{default:L(()=>[e(l)&&e(l).appliedCoupons?(r(),p("div",ss,[(r(!0),p(q,null,ee(e(l).appliedCoupons,(k,z)=>(r(),p("div",{key:(k==null?void 0:k.code)||z,class:"flex flex-wrap mt-2 flex-2"},[k!=null&&k.code?(r(),p("div",os,[t("span",{innerHTML:k.code},null,8,ns),$(v,{name:"ion:close",class:"rounded-full cursor-pointer hover:bg-brand-gold hover:text-white",onClick:N=>e(s)(k.code)},null,8,["onClick"])])):y("",!0)]))),128))])):y("",!0)]),_:1})])}}}),as=Object.assign(ls,{__name:"AddCoupon"}),is={key:0,class:"bg-white rounded-lg shadow-lg mb-8 w-full min-h-[280px] p-4 sm:p-8 relative md:max-w-md md:top-32 md:sticky"},rs={class:"mb-6 text-xl font-semibold leading-none"},ds={class:"flex flex-col gap-4 overflow-y-auto"},us={class:"grid gap-1 text-sm font-semibold text-gray-500"},cs={class:"flex justify-between"},ps=["innerHTML"],ms={class:"flex justify-between"},fs={class:"text-gray-700 tabular-nums"},_s={key:0,class:"flex justify-between"},gs={class:"text-brand-gold tabular-nums"},hs=["innerHTML"],ys={class:"flex justify-between mt-4"},vs=["innerHTML"],bs={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-50"},$s={__name:"OrderSummary",setup(m){const{cart:l,isUpdatingCart:i}=I();return(n,s)=>{const o=We,d=as,h=ie;return e(l)?(r(),p("aside",is,[t("h2",rs,u(n.$t("messages.shop.orderSummary")),1),t("ul",ds,[(r(!0),p(q,null,ee(e(l).contents.nodes,a=>(r(),A(o,{key:a.key,item:a},null,8,["item"]))),128))]),$(d,{class:"my-8"}),t("div",us,[t("div",cs,[t("span",null,u(n.$t("messages.shop.subtotal")),1),t("span",{class:"text-gray-700 tabular-nums",innerHTML:e(l).subtotal},null,8,ps)]),t("div",ms,[t("span",null,u(n.$t("messages.general.shipping")),1),t("span",fs,u(parseFloat(e(l).shippingTotal)>0?"+":"")+" "+u(e(l).shippingTotal),1)]),$(Z,{name:"scale-y",mode:"out-in"},{default:L(()=>[e(l)&&e(l).appliedCoupons?(r(),p("div",_s,[t("span",null,u(n.$t("messages.shop.discount")),1),t("span",gs,[s[0]||(s[0]=K("- ")),t("span",{innerHTML:e(l).discountTotal},null,8,hs)])])):y("",!0)]),_:1}),t("div",ys,[t("span",null,u(n.$t("messages.shop.total")),1),t("span",{class:"text-lg font-bold text-gray-700 tabular-nums",innerHTML:e(l).total},null,8,vs)])]),Ie(n.$slots,"default"),e(i)?(r(),p("div",bs,[$(h)])):y("",!0)])):y("",!0)}}};var $e="https://js.stripe.com/v3",ws=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,me="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",xs=function(){for(var l=document.querySelectorAll('script[src^="'.concat($e,'"]')),i=0;i<l.length;i++){var n=l[i];if(ws.test(n.src))return n}return null},fe=function(l){var i="",n=document.createElement("script");n.src="".concat($e).concat(i);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(n),n},ks=function(l,i){!l||!l._registerWrapper||l._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:i})},Y=null,X=null,Q=null,Ss=function(l){return function(){l(new Error("Failed to load Stripe.js"))}},Cs=function(l,i){return function(){window.Stripe?l(window.Stripe):i(new Error("Stripe.js not available"))}},Vs=function(l){return Y!==null?Y:(Y=new Promise(function(i,n){if(typeof window>"u"||typeof document>"u"){i(null);return}if(window.Stripe&&l&&console.warn(me),window.Stripe){i(window.Stripe);return}try{var s=xs();if(s&&l)console.warn(me);else if(!s)s=fe(l);else if(s&&Q!==null&&X!==null){var o;s.removeEventListener("load",Q),s.removeEventListener("error",X),(o=s.parentNode)===null||o===void 0||o.removeChild(s),s=fe(l)}Q=Cs(i,n),X=Ss(n),s.addEventListener("load",Q),s.addEventListener("error",X)}catch(d){n(d);return}}),Y.catch(function(i){return Y=null,Promise.reject(i)}))},Us=function(l,i,n){if(l===null)return null;var s=l.apply(void 0,i);return ks(s,n),s},F,we=!1,xe=function(){return F||(F=Vs(null).catch(function(l){return F=null,Promise.reject(l)}),F)};Promise.resolve().then(function(){return xe()}).catch(function(m){we||console.warn(m)});var Es=function(){for(var l=arguments.length,i=new Array(l),n=0;n<l;n++)i[n]=arguments[n];we=!0;var s=Date.now();return xe().then(function(o){return Us(o,i,s)})};const Ms={class:"flex flex-col min-h-[600px]"},Ps={key:0,class:"flex flex-col items-center justify-center flex-1 mb-12"},Ts={class:"text-2xl font-bold mb-2"},Ls={class:"text-gray-400 mb-4"},As={class:"grid w-full max-w-2xl gap-8 checkout-form md:flex-1"},Is={key:0},Ns={class:"w-full mt-4"},Ds={for:"email"},Os={key:0,class:"mt-1 text-sm text-red-500"},js={class:"w-full mt-4"},qs={for:"username"},Hs={key:0,class:"w-full my-2"},zs={for:"email"},Bs={key:1,class:"flex items-center gap-2 my-2"},Gs={class:"w-full mb-3 text-2xl font-semibold"},Rs={key:1,for:"shipToDifferentAddress",class:"flex items-center gap-2"},Ws={key:0},Ys={class:"mb-4 text-xl font-semibold"},Fs={key:2},Ks={class:"mb-4 text-xl font-semibold"},Zs={key:3,class:"mt-2 col-span-full"},Js={class:"mb-4 text-xl font-semibold"},Xs={class:"mb-4 text-xl font-semibold"},Qs=["placeholder"],eo=["disabled"],io=H({__name:"checkout",async setup(m){var W;let l,i;const{t:n}=Ne(),{query:s}=De(),{cart:o,isUpdatingCart:d,paymentGateways:h}=I(),{customer:a,viewer:c}=oe(),{orderInput:f,isProcessingOrder:v,proccessCheckout:k}=re(),N=((W=ge().public)==null?void 0:W.STRIPE_PUBLISHABLE_KEY)||null,D=j(v.value?n("messages.general.processing"):n("messages.shop.checkoutButton")),se=ae(()=>v.value||d.value||!f.value.paymentMethod),U=j(!1),E=N?([l,i]=Oe(()=>Es(N)),l=await l,i(),l):null,O=j(),B=j(!1);je(async()=>{s.cancel_order&&window.close()});const J=async()=>{var C;D.value=n("messages.general.processing");const{stripePaymentIntent:g}=await Be(),_=(g==null?void 0:g.clientSecret)||"";try{if(f.value.paymentMethod.id==="stripe"&&E&&O.value){const P=O.value.getElement("card"),{setupIntent:V}=await E.confirmCardSetup(_,{payment_method:{card:P}}),{source:T}=await E.createSource(P);T&&f.value.metaData.push({key:"_stripe_source_id",value:T.id}),V&&f.value.metaData.push({key:"_stripe_intent_id",value:V.id}),B.value=(V==null?void 0:V.status)==="succeeded"||!1,f.value.transactionId=((C=T==null?void 0:T.created)==null?void 0:C.toString())||new Date().getTime().toString()}}catch(P){console.error(P),D.value=n("messages.shop.placeOrder")}k(B.value)},M=g=>{O.value=g},b=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,G=g=>{g&&(U.value=!b.test(g))},R=g=>{g&&U.value&&(U.value=!b.test(g))};return qe({title:n("messages.shop.checkout")}),(g,_)=>{var ue;const C=te,P=Ge,V=ze,T=Re,ke=ft,Se=It,Ce=Ht,Ve=Ft,Ue=Jt,de=ie,Ee=$s;return r(),p("div",Ms,[e(o)&&e(a)?(r(),p(q,{key:0},[e(o).isEmpty?(r(),p("div",Ps,[$(C,{name:"ion:cart-outline",size:"156",class:"opacity-25 mb-5"}),t("h2",Ts,u(g.$t("messages.shop.cartEmpty")),1),t("span",Ls,u(g.$t("messages.shop.addProductsInYourCart")),1),$(V,{to:"/products",class:"block"},{default:L(()=>[$(P,null,{default:L(()=>[K(u(g.$t("messages.shop.browseOurProducts")),1)]),_:1})]),_:1})])):(r(),p("form",{key:1,class:"container flex flex-wrap items-start gap-8 my-16 justify-evenly lg:gap-20",onSubmit:ye(J,["prevent"])},[t("div",As,[!e(c)&&e(a).billing?(r(),p("div",Is,[_[12]||(_[12]=t("h2",{class:"w-full mb-2 text-2xl font-semibold leading-none"}," Contact Information ",-1)),_[13]||(_[13]=t("p",{class:"mt-1 text-sm text-gray-500"},[K(" Already have an account? "),t("a",{href:"/my-account",class:"text-brand-gold text-semibold"},"Log in"),K(". ")],-1)),t("div",Ns,[t("label",Ds,u(g.$t("messages.billing.email")),1),w(t("input",{"onUpdate:modelValue":_[0]||(_[0]=x=>e(a).billing.email=x),placeholder:"johndoe@email.com",autocomplete:"email",type:"email",name:"email",class:le({"has-error":e(U)}),onBlur:_[1]||(_[1]=x=>G(e(a).billing.email)),onInput:_[2]||(_[2]=x=>R(e(a).billing.email)),required:""},null,34),[[S,e(a).billing.email]]),$(Z,{name:"scale-y",mode:"out-in"},{default:L(()=>[e(U)?(r(),p("div",Os," Invalid email address ")):y("",!0)]),_:1})]),e(f).createAccount?(r(),p(q,{key:0},[t("div",js,[t("label",qs,u(g.$t("messages.account.username")),1),w(t("input",{"onUpdate:modelValue":_[3]||(_[3]=x=>e(f).username=x),placeholder:"johndoe",autocomplete:"username",type:"text",name:"username",required:""},null,512),[[S,e(f).username]])]),e(f).createAccount?(r(),p("div",Hs,[t("label",zs,u(g.$t("messages.account.password")),1),$(T,{id:"password",class:"my-2",modelValue:e(f).password,"onUpdate:modelValue":_[4]||(_[4]=x=>e(f).password=x),placeholder:"••••••••••",required:!0},null,8,["modelValue"])])):y("",!0)],64)):y("",!0),e(c)?y("",!0):(r(),p("div",Bs,[_[11]||(_[11]=t("label",{for:"creat-account"},"Create an account?",-1)),w(t("input",{id:"creat-account","onUpdate:modelValue":_[5]||(_[5]=x=>e(f).createAccount=x),type:"checkbox",name:"creat-account"},null,512),[[pe,e(f).createAccount]])]))])):y("",!0),t("div",null,[t("h2",Gs,u(g.$t("messages.billing.billingDetails")),1),$(ke,{modelValue:e(a).billing,"onUpdate:modelValue":_[6]||(_[6]=x=>e(a).billing=x)},null,8,["modelValue"])]),e(o).availableShippingMethods.length>0?(r(),p("label",Rs,[t("span",null,u(g.$t("messages.billing.differentAddress")),1),w(t("input",{id:"shipToDifferentAddress","onUpdate:modelValue":_[7]||(_[7]=x=>e(f).shipToDifferentAddress=x),type:"checkbox",name:"shipToDifferentAddress"},null,512),[[pe,e(f).shipToDifferentAddress]])])):y("",!0),$(Z,{name:"scale-y",mode:"out-in"},{default:L(()=>[e(f).shipToDifferentAddress?(r(),p("div",Ws,[t("h2",Ys,u(g.$t("messages.general.shippingDetails")),1),$(Se,{modelValue:e(a).shipping,"onUpdate:modelValue":_[8]||(_[8]=x=>e(a).shipping=x)},null,8,["modelValue"])])):y("",!0)]),_:1}),e(o).availableShippingMethods.length?(r(),p("div",Fs,[t("h3",Ks,u(g.$t("messages.general.shippingSelect")),1),$(Ce,{options:e(o).availableShippingMethods[0].rates,"active-option":e(o).chosenShippingMethods[0]},null,8,["options","active-option"])])):y("",!0),(ue=e(h))!=null&&ue.nodes.length?(r(),p("div",Zs,[t("h2",Js,u(g.$t("messages.billing.paymentOptions")),1),$(Ve,{modelValue:e(f).paymentMethod,"onUpdate:modelValue":_[9]||(_[9]=x=>e(f).paymentMethod=x),class:"mb-4",paymentGateways:e(h)},null,8,["modelValue","paymentGateways"]),e(E)?w((r(),A(Ue,{key:0,stripe:e(E),onUpdateElement:M},null,8,["stripe"])),[[He,e(f).paymentMethod.id=="stripe"]]):y("",!0)])):y("",!0),t("div",null,[t("h2",Xs,u(g.$t("messages.shop.orderNote"))+" ("+u(g.$t("messages.general.optional"))+") ",1),w(t("textarea",{id:"order-note","onUpdate:modelValue":_[10]||(_[10]=x=>e(f).customerNote=x),name:"order-note",class:"w-full min-h-[100px]",rows:"4",placeholder:g.$t("messages.shop.orderNotePlaceholder")},null,8,Qs),[[S,e(f).customerNote]])])]),$(Ee,null,{default:L(()=>[t("button",{class:"flex items-center justify-center w-full gap-3 p-3 mt-4 font-semibold text-center text-white rounded-lg shadow-md bg-brand-gold hover:bg-brand-gold/[0.8] disabled:cursor-not-allowed disabled:bg-gray-400",disabled:e(se)},[K(u(e(D)),1),e(v)?(r(),A(de,{key:0,color:"#fff",size:"18"})):y("",!0)],8,eo)]),_:1})],32))],64)):(r(),A(de,{key:1,class:"m-auto"}))])}}});export{io as default};
